## 什么是组件内守卫和异步路由组件

**组件内守卫：**
组件内守卫是指在Vue组件中定义的导航守卫。它们允许你在组件级别上控制导航过程。Vue组件内部的导航守卫包括：`beforeRouteEnter`、`beforeRouteUpdate`和`beforeRouteLeave`。

示例：

```javascript
export default {
  beforeRouteEnter(to, from, next) {
    // 在进入路由前调用
    // 可以访问组件实例，但是在这里无法访问this
    next();
  },
  beforeRouteUpdate(to, from, next) {
    // 在当前组件复用时调用，例如同一组件不同参数的情况
    // 可以访问组件实例this
    next();
  },
  beforeRouteLeave(to, from, next) {
    // 在离开当前路由前调用
    // 可以访问组件实例this
    next();
  }
};
```

**异步路由组件：**
异步路由组件是指使用动态导入（异步加载）的方式加载的路由组件。它允许你在需要时按需加载组件，减小初始加载的包大小，提高应用性能。

示例：

```javascript
const Home = () => import('./views/Home.vue');
const About = () => import('./views/About.vue');
const Contact = () => import('./views/Contact.vue');

const routes = [
  { path: '/', component: Home },
  { path: '/about', component: About },
  { path: '/contact', component: Contact }
];
```

在路由导航过程中，`解析守卫`将在以上两种情况之后被调用。也就是说，它会在异步路由组件加载完成后、所有组件内守卫被调用之后，但在实际导航确认之前被触发。在解析守卫中，你可以执行一些异步操作或执行其他逻辑，然后再继续路由导航的确认。



## 路由独享的守卫

`beforeEnter` 守卫 **只在进入路由时触发**，不会在 `params`、`query` 或 `hash` 改变时触发。例如，从 `/users/2` 进入到 `/users/3` 或者从 `/users/2#info` 进入到 `/users/2#projects`。它们只有在 **从一个不同的** 路由导航时，才会被触发。

你也可以将一个函数数组传递给 `beforeEnter`，这在为不同的路由重用守卫时很有用：

```javascript
function removeQueryParams(to) {
  if (Object.keys(to.query).length)
    return { path: to.path, query: {}, hash: to.hash }
}

function removeHash(to) {
  if (to.hash) return { path: to.path, query: to.query, hash: '' }
}

const routes = [
  {
    path: '/users/:id',
    component: UserDetails,
    beforeEnter: [removeQueryParams, removeHash],
  },
  {
    path: '/about',
    component: UserDetails,
    beforeEnter: [removeQueryParams],
  },
]
```

请注意，你也可以通过使用[路径 meta 字段](https://router.vuejs.org/zh/guide/advanced/meta.html)和[全局导航守卫](https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#global-before-guards)来实现类似的行为。